
#include <icepack/mesh.hpp>
#include "testing.hpp"
#include <fstream>

const std::string mesh_string =
  "$MeshFormat\n"
  "2.2 0 8\n"
  "$EndMeshFormat\n"
  "$Nodes\n"
  "25\n"
  " 1 -0.7071 -0.7071  0.0000\n"
  " 2  0.7071 -0.7071  0.0000\n"
  " 3 -0.2668 -0.2668  0.0000\n"
  " 4  0.2668 -0.2668  0.0000\n"
  " 5 -0.2668  0.2668  0.0000\n"
  " 6  0.2668  0.2668  0.0000\n"
  " 7 -0.7071  0.7071  0.0000\n"
  " 8  0.7071  0.7071  0.0000\n"
  " 9  0.0000 -1.0000  0.0000\n"
  "10  0.5000 -0.5000  0.0000\n"
  "11  0.0000 -0.3139  0.0000\n"
  "12 -0.5000 -0.5000  0.0000\n"
  "13  0.0000 -0.6621  0.0000\n"
  "14 -0.3139  0.0000  0.0000\n"
  "15 -0.5000  0.5000  0.0000\n"
  "16 -1.0000  0.0000  0.0000\n"
  "17 -0.6621  0.0000  0.0000\n"
  "18  0.3139  0.0000  0.0000\n"
  "19  0.0000  0.3139  0.0000\n"
  "20  0.0000  0.0000  0.0000\n"
  "21  1.0000  0.0000  0.0000\n"
  "22  0.5000  0.5000  0.0000\n"
  "23  0.6621  0.0000  0.0000\n"
  "24  0.0000  1.0000  0.0000\n"
  "25  0.0000  0.6621  0.0000\n"
  "$EndNodes\n"
  "$Elements\n"
  "20\n"
  " 1 3 0  1  9 13 12 \n"
  " 2 3 0  9  2 10 13 \n"
  " 3 3 0 13 10  4 11 \n"
  " 4 3 0 12 13 11  3 \n"
  " 5 3 0  1 12 17 16 \n"
  " 6 3 0 12  3 14 17 \n"
  " 7 3 0 17 14  5 15 \n"
  " 8 3 0 16 17 15  7 \n"
  " 9 3 0  3 11 20 14 \n"
  "10 3 0 11  4 18 20 \n"
  "11 3 0 20 18  6 19 \n"
  "12 3 0 14 20 19  5 \n"
  "13 3 0  2 21 23 10 \n"
  "14 3 0 21  8 22 23 \n"
  "15 3 0 23 22  6 18 \n"
  "16 3 0 10 23 18  4 \n"
  "17 3 0  7 15 25 24 \n"
  "18 3 0 15  5 19 25 \n"
  "19 3 0 25 19  6 22 \n"
  "20 3 0 24 25 22  8 \n"
  "$EndElements\n"
  " \n";

int main(void)
{
  const std::string filename = "circle_2d.msh";
  std::ofstream stream(filename);
  stream << mesh_string;
  stream.close();

  const dealii::Triangulation<2> tria = icepack::read_msh(filename);
  CHECK(tria.n_cells() == 20);

  return 0;
}

